<!DOCTYPE html> <html> <head> <meta charset="UTF-8"> <title>QRスキャナ - RoomB（CROSTAFF）</title> <style> body { font-family: sans-serif; text-align: center; padding: 20px; } #reader { width: 300px; margin: auto; } #result { margin-top: 20px; font-size: 18px; } </style> </head> <body> <h1>QRスキャナ - RoomB</h1> <p>QRコードをスキャンしてください</p> <div id="reader"></div> <div id="result">スキャン待機中...</div> <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script> <script> const ROOM_NAME = "RoomB"; const resultDiv = document.getElementById("result"); const reader = new Html5Qrcode("reader"); function sendToWebApp(userId) { const url = `https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec?userId=${encodeURIComponent(userId)}&room=${encodeURIComponent(ROOM_NAME)}`; fetch(url) .then(res => res.text()) .then(response => { resultDiv.innerHTML = `✅ 登録完了: ${userId} @ ${ROOM_NAME}`; }) .catch(err => { resultDiv.innerHTML = `❌ エラー: ${err}`; }); } function onScanSuccess(decodedText) { reader.stop(); resultDiv.innerHTML = `📷 読み取り成功: ${decodedText}`; sendToWebApp(decodedText); setTimeout(() => { reader.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, onScanSuccess); resultDiv.innerHTML = "スキャン待機中..."; }, 3000); } Html5Qrcode.getCameras().then(devices => { if (devices.length) { reader.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, onScanSuccess); } else { resultDiv.innerHTML = "📷 カメラが見つかりません"; } }); </script> </body> </html>